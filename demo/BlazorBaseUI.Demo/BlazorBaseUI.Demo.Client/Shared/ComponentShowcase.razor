@inject NavigationManager NavManager

<div class="space-y-8">
    <!-- Header with Mode Switch -->
    <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
        <div>
            <h2 class="text-3xl font-bold tracking-tight text-gray-900">
                @ComponentName
            </h2>
            <p class="mt-2 text-lg text-gray-600">@Description</p>
        </div>

        <!-- Render Mode Toggle -->
        <div class="flex items-center gap-3 rounded-lg border border-gray-200 bg-white p-1 shadow-sm">
            <button type="button"
                    class="@GetModeButtonClass(false)"
                    @onclick="() => SwitchMode(false)">
                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 01-3-3m3 3a3 3 0 100 6h13.5a3 3 0 100-6m-16.5-3a3 3 0 013-3h13.5a3 3 0 013 3m-19.5 0a4.5 4.5 0 01.9-2.7L5.737 5.1a3.375 3.375 0 012.7-1.35h7.126c1.062 0 2.062.5 2.7 1.35l2.587 3.45a4.5 4.5 0 01.9 2.7m0 0a3 3 0 01-3 3m0 3h.008v.008h-.008v-.008zm0-6h.008v.008h-.008v-.008zm-3 6h.008v.008h-.008v-.008zm0-6h.008v.008h-.008v-.008z" />
                </svg>
                <span class="text-sm font-medium">Server</span>
            </button>

            <button type="button"
                    class="@GetModeButtonClass(true)"
                    @onclick="() => SwitchMode(true)">
                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25" />
                </svg>
                <span class="text-sm font-medium">WASM</span>
            </button>
        </div>
    </div>

    <!-- Current Mode Indicator -->
    <div class="rounded-lg border @GetModeBorderClass() bg-white p-4 shadow-sm">
        <div class="flex items-center gap-2">
            <div class="@GetModeIndicatorClass() h-2 w-2 rounded-full"></div>
            <span class="text-sm font-medium text-gray-700">
                Render Mode: <span class="@GetModeTextClass()">@(IsWasmMode ? "InteractiveWebAssembly" : "InteractiveServer")</span>
            </span>
        </div>
    </div>

    <!-- Component Demo Area -->
    <div class="space-y-6">
        @ChildContent
    </div>
</div>

@code {
    [Parameter, EditorRequired]
    public string ComponentName { get; set; } = string.Empty;

    [Parameter, EditorRequired]
    public string Description { get; set; } = string.Empty;

    [Parameter, EditorRequired]
    public string BaseRoute { get; set; } = string.Empty;

    [Parameter, EditorRequired]
    public bool IsWasmMode { get; set; }

    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    private void SwitchMode(bool toWasm)
    {
        if (toWasm == IsWasmMode) return;

        var route = toWasm ? $"{BaseRoute}/wasm" : BaseRoute;
        NavManager.NavigateTo(route);
    }

    private string GetModeButtonClass(bool isWasmButton)
    {
        var isActive = isWasmButton == IsWasmMode;
        return isActive
            ? "flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-white transition-colors"
            : "flex items-center gap-2 rounded-md px-3 py-2 text-gray-600 hover:bg-gray-100 transition-colors";
    }

    private string GetModeBorderClass() =>
        IsWasmMode ? "border-purple-200" : "border-blue-200";

    private string GetModeIndicatorClass() =>
        IsWasmMode ? "bg-purple-500 animate-pulse" : "bg-blue-500 animate-pulse";

    private string GetModeTextClass() =>
        IsWasmMode ? "text-purple-700" : "text-blue-700";
}