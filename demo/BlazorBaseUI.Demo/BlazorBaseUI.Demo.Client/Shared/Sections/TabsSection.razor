@using BlazorBaseUI.Tabs

<ComponentShowcase ComponentName="Tabs"
                   Description="A set of layered sections of content, known as tab panels, that display one panel of content at a time."
                   BaseRoute="/tabs"
                   IsWasmMode="IsWasmMode">

<DemoSection Title="Basic Tabs"
             Description="Simple tabbed interface with three tabs and corresponding panels.">
    <div class="w-full max-w-md">
        <TabsRoot TValue="string" DefaultValue="@("tab1")">
            <TabsList TValue="string"
                      ClassValue="@(_ => TabsListClass())">
                <TabsTab TValue="string"
                         Value="@("tab1")"
                         ClassValue="@(state => TabClass(state))">
                    Account
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("tab2")"
                         ClassValue="@(state => TabClass(state))">
                    Documents
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("tab3")"
                         ClassValue="@(state => TabClass(state))">
                    Settings
                </TabsTab>
            </TabsList>
            <TabsPanel TValue="string"
                       Value="@("tab1")"
                       ClassValue="@(_ => PanelClass())">
                <h3 class="font-semibold text-gray-900">Account Settings</h3>
                <p class="mt-2 text-gray-600">Manage your account details and preferences.</p>
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("tab2")"
                       ClassValue="@(_ => PanelClass())">
                <h3 class="font-semibold text-gray-900">Documents</h3>
                <p class="mt-2 text-gray-600">View and manage your uploaded documents.</p>
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("tab3")"
                       ClassValue="@(_ => PanelClass())">
                <h3 class="font-semibold text-gray-900">Settings</h3>
                <p class="mt-2 text-gray-600">Configure application settings and notifications.</p>
            </TabsPanel>
        </TabsRoot>
    </div>
</DemoSection>

<DemoSection Title="Controlled Tabs"
             Description="Tab selection controlled externally via Value parameter. Can be changed programmatically.">
    <div class="flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="string"
                      Value="@controlledValue"
                      ValueChanged="@(v => controlledValue = v)">
                <TabsList TValue="string"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("first")"
                             ClassValue="@(state => TabClass(state))">
                        First
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("second")"
                             ClassValue="@(state => TabClass(state))">
                        Second
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("third")"
                             ClassValue="@(state => TabClass(state))">
                        Third
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="string"
                           Value="@("first")"
                           ClassValue="@(_ => PanelClass())">
                    First panel content
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("second")"
                           ClassValue="@(_ => PanelClass())">
                    Second panel content
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("third")"
                           ClassValue="@(_ => PanelClass())">
                    Third panel content
                </TabsPanel>
            </TabsRoot>
        </div>
        <div class="flex items-center gap-4">
            <span class="text-sm text-gray-700">Selected: <strong>@(controlledValue ?? "none")</strong></span>
            <button type="button"
                    class="rounded bg-indigo-600 px-3 py-1 text-sm text-white hover:bg-indigo-700"
                    @onclick="@(() => controlledValue = "second")">
                Select Second
            </button>
            <button type="button"
                    class="rounded bg-gray-600 px-3 py-1 text-sm text-white hover:bg-gray-700"
                    @onclick="@(() => controlledValue = "first")">
                Select First
            </button>
        </div>
    </div>
</DemoSection>

<DemoSection Title="Disabled Tabs"
             Description="Individual tabs can be disabled. Disabled tabs cannot be selected or focused.">
    <div class="w-full max-w-md">
        <TabsRoot TValue="string" DefaultValue="@("enabled1")">
            <TabsList TValue="string"
                      ClassValue="@(_ => TabsListClass())">
                <TabsTab TValue="string"
                         Value="@("enabled1")"
                         ClassValue="@(state => TabClass(state))">
                    Enabled
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("disabled1")"
                         Disabled="true"
                         ClassValue="@(state => TabClass(state))">
                    Disabled
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("enabled2")"
                         ClassValue="@(state => TabClass(state))">
                    Also Enabled
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("disabled2")"
                         Disabled="true"
                         ClassValue="@(state => TabClass(state))">
                    Also Disabled
                </TabsTab>
            </TabsList>
            <TabsPanel TValue="string"
                       Value="@("enabled1")"
                       ClassValue="@(_ => PanelClass())">
                This is the first enabled tab's content.
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("disabled1")"
                       ClassValue="@(_ => PanelClass())">
                This panel belongs to a disabled tab.
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("enabled2")"
                       ClassValue="@(_ => PanelClass())">
                This is another enabled tab's content.
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("disabled2")"
                       ClassValue="@(_ => PanelClass())">
                This panel also belongs to a disabled tab.
            </TabsPanel>
        </TabsRoot>
    </div>
</DemoSection>

<DemoSection Title="Auto-Select First Enabled Tab"
             Description="When no DefaultValue is provided, the first non-disabled tab is automatically selected.">
    <div class="w-full max-w-md">
        <TabsRoot TValue="string">
            <TabsList TValue="string"
                      ClassValue="@(_ => TabsListClass())">
                <TabsTab TValue="string"
                         Value="@("skip1")"
                         Disabled="true"
                         ClassValue="@(state => TabClass(state))">
                    Disabled 1
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("skip2")"
                         Disabled="true"
                         ClassValue="@(state => TabClass(state))">
                    Disabled 2
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("auto-selected")"
                         ClassValue="@(state => TabClass(state))">
                    Auto Selected
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("another")"
                         ClassValue="@(state => TabClass(state))">
                    Another Tab
                </TabsTab>
            </TabsList>
            <TabsPanel TValue="string"
                       Value="@("skip1")"
                       ClassValue="@(_ => PanelClass())">
                Disabled panel 1
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("skip2")"
                       ClassValue="@(_ => PanelClass())">
                Disabled panel 2
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("auto-selected")"
                       ClassValue="@(_ => PanelClass())">
                This tab was automatically selected because it's the first enabled tab.
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("another")"
                       ClassValue="@(_ => PanelClass())">
                Another panel
            </TabsPanel>
        </TabsRoot>
    </div>
    <p class="mt-2 text-sm text-gray-500">
        The "Auto Selected" tab is selected by default because the first two tabs are disabled.
    </p>
</DemoSection>

<DemoSection Title="Vertical Orientation"
             Description="Tabs can be arranged vertically. Arrow Up/Down navigate instead of Left/Right.">
    <div class="flex w-full max-w-lg gap-4">
        <TabsRoot TValue="string"
                  DefaultValue="@("v1")"
                  Orientation="Orientation.Vertical"
                  ClassValue="@(_ => "flex gap-4")">
            <TabsList TValue="string"
                      ClassValue="@(_ => VerticalTabsListClass())">
                <TabsTab TValue="string"
                         Value="@("v1")"
                         ClassValue="@(state => VerticalTabClass(state))">
                    General
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("v2")"
                         ClassValue="@(state => VerticalTabClass(state))">
                    Security
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("v3")"
                         ClassValue="@(state => VerticalTabClass(state))">
                    Notifications
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("v4")"
                         ClassValue="@(state => VerticalTabClass(state))">
                    Advanced
                </TabsTab>
            </TabsList>
            <div class="flex-1">
                <TabsPanel TValue="string"
                           Value="@("v1")"
                           ClassValue="@(_ => VerticalPanelClass())">
                    <h3 class="font-semibold">General Settings</h3>
                    <p class="mt-2 text-gray-600">Configure your general preferences here.</p>
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("v2")"
                           ClassValue="@(_ => VerticalPanelClass())">
                    <h3 class="font-semibold">Security Settings</h3>
                    <p class="mt-2 text-gray-600">Manage passwords and two-factor authentication.</p>
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("v3")"
                           ClassValue="@(_ => VerticalPanelClass())">
                    <h3 class="font-semibold">Notification Settings</h3>
                    <p class="mt-2 text-gray-600">Choose which notifications you want to receive.</p>
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("v4")"
                           ClassValue="@(_ => VerticalPanelClass())">
                    <h3 class="font-semibold">Advanced Settings</h3>
                    <p class="mt-2 text-gray-600">Power user options and developer settings.</p>
                </TabsPanel>
            </div>
        </TabsRoot>
    </div>
    <p class="mt-2 text-sm text-gray-500">
        Use Arrow Up/Down to navigate between tabs. The tablist has aria-orientation="vertical".
    </p>
</DemoSection>

<DemoSection Title="Activation Direction"
             Description="The data-activation-direction attribute indicates the direction of tab change (left/right or up/down).">
    <div class="flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="string"
                      Value="@directionValue"
                      ValueChanged="@HandleDirectionValueChange"
                      OnValueChange="@HandleDirectionChange"
                      ClassValue="@(state => $"rounded-lg border p-4 {GetDirectionBorderClass(state)}")">
                <TabsList TValue="string"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("dir1")"
                             ClassValue="@(state => TabClass(state))">
                        Tab 1
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("dir2")"
                             ClassValue="@(state => TabClass(state))">
                        Tab 2
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("dir3")"
                             ClassValue="@(state => TabClass(state))">
                        Tab 3
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="string"
                           Value="@("dir1")"
                           ClassValue="@(_ => PanelClass())">
                    Panel 1
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("dir2")"
                           ClassValue="@(_ => PanelClass())">
                    Panel 2
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("dir3")"
                           ClassValue="@(_ => PanelClass())">
                    Panel 3
                </TabsPanel>
            </TabsRoot>
        </div>
        <div class="text-sm text-gray-700">
            <strong>Last activation direction:</strong> @lastActivationDirection
        </div>
        <p class="text-sm text-gray-500">
            Click tabs to see the activation direction change. Moving left sets "left", moving right sets "right".
        </p>
    </div>
</DemoSection>

<DemoSection Title="Keyboard Navigation: ActivateOnFocus"
             Description="When ActivateOnFocus is true (default for radio-like behavior), arrow keys both move focus AND activate the tab.">
    <div class="flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="string"
                      Value="@activateOnFocusValue"
                      ValueChanged="@(v => activateOnFocusValue = v)">
                <TabsList TValue="string"
                          ActivateOnFocus="true"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("aof1")"
                             ClassValue="@(state => TabClass(state))">
                        Alpha
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("aof2")"
                             ClassValue="@(state => TabClass(state))">
                        Beta
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("aof3")"
                             ClassValue="@(state => TabClass(state))">
                        Gamma
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="string"
                           Value="@("aof1")"
                           ClassValue="@(_ => PanelClass())">
                    Alpha content
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("aof2")"
                           ClassValue="@(_ => PanelClass())">
                    Beta content
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("aof3")"
                           ClassValue="@(_ => PanelClass())">
                    Gamma content
                </TabsPanel>
            </TabsRoot>
        </div>
        <div class="text-sm text-gray-600">
            <strong>Selected:</strong> @(activateOnFocusValue ?? "(none)")
        </div>
        <p class="text-sm text-gray-500">
            1. Click on "Alpha" to focus it<br/>
            2. Press ArrowRight - focus moves to "Beta" AND "Beta" becomes selected<br/>
            3. This matches the WAI-ARIA tabs pattern with automatic activation
        </p>
    </div>
</DemoSection>

<DemoSection Title="Keyboard Navigation: Manual Activation"
             Description="When ActivateOnFocus is false, arrow keys only move focus. Enter or Space activates the focused tab.">
    <div class="flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="string"
                      Value="@manualActivationValue"
                      ValueChanged="@(v => manualActivationValue = v)">
                <TabsList TValue="string"
                          ActivateOnFocus="false"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("man1")"
                             ClassValue="@(state => TabClass(state))">
                        One
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("man2")"
                             ClassValue="@(state => TabClass(state))">
                        Two
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("man3")"
                             ClassValue="@(state => TabClass(state))">
                        Three
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="string"
                           Value="@("man1")"
                           ClassValue="@(_ => PanelClass())">
                    Panel One
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("man2")"
                           ClassValue="@(_ => PanelClass())">
                    Panel Two
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("man3")"
                           ClassValue="@(_ => PanelClass())">
                    Panel Three
                </TabsPanel>
            </TabsRoot>
        </div>
        <div class="text-sm text-gray-600">
            <strong>Selected:</strong> @(manualActivationValue ?? "(none)")
        </div>
        <p class="text-sm text-gray-500">
            1. Click on "One" to focus and select it<br/>
            2. Press ArrowRight - focus moves to "Two" but "One" remains selected<br/>
            3. Press Enter or Space to activate "Two"
        </p>
    </div>
</DemoSection>

<DemoSection Title="Keyboard Navigation: Focus Looping"
             Description="Navigation loops from the last tab back to the first, and vice versa.">
    <div class="flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="string"
                      Value="@loopValue"
                      ValueChanged="@(v => loopValue = v)">
                <TabsList TValue="string"
                          LoopFocus="true"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("loop1")"
                             ClassValue="@(state => TabClass(state))">
                        First
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("loop2")"
                             ClassValue="@(state => TabClass(state))">
                        Second
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("loop3")"
                             ClassValue="@(state => TabClass(state))">
                        Third (Last)
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="string"
                           Value="@("loop1")"
                           ClassValue="@(_ => PanelClass())">
                    First panel
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("loop2")"
                           ClassValue="@(_ => PanelClass())">
                    Second panel
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("loop3")"
                           ClassValue="@(_ => PanelClass())">
                    Third panel
                </TabsPanel>
            </TabsRoot>
        </div>
        <div class="text-sm text-gray-600">
            <strong>Selected:</strong> @(loopValue ?? "(none)")
        </div>
        <p class="text-sm text-gray-500">
            1. Select "Third (Last)" and press ArrowRight → loops to "First"<br/>
            2. Select "First" and press ArrowLeft → loops to "Third (Last)"
        </p>
    </div>
</DemoSection>

<DemoSection Title="Keyboard Navigation: Skip Disabled Tabs"
             Description="Arrow key navigation automatically skips disabled tabs.">
    <div class="flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="string"
                      Value="@skipDisabledValue"
                      ValueChanged="@(v => skipDisabledValue = v)">
                <TabsList TValue="string"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("sd1")"
                             ClassValue="@(state => TabClass(state))">
                        Item 1
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("sd2")"
                             Disabled="true"
                             ClassValue="@(state => TabClass(state))">
                        Item 2 (disabled)
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("sd3")"
                             Disabled="true"
                             ClassValue="@(state => TabClass(state))">
                        Item 3 (disabled)
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("sd4")"
                             ClassValue="@(state => TabClass(state))">
                        Item 4
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("sd5")"
                             ClassValue="@(state => TabClass(state))">
                        Item 5
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="string"
                           Value="@("sd1")"
                           ClassValue="@(_ => PanelClass())">
                    Panel 1
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("sd2")"
                           ClassValue="@(_ => PanelClass())">
                    Panel 2
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("sd3")"
                           ClassValue="@(_ => PanelClass())">
                    Panel 3
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("sd4")"
                           ClassValue="@(_ => PanelClass())">
                    Panel 4
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("sd5")"
                           ClassValue="@(_ => PanelClass())">
                    Panel 5
                </TabsPanel>
            </TabsRoot>
        </div>
        <div class="text-sm text-gray-600">
            <strong>Selected:</strong> @(skipDisabledValue ?? "(none)")
        </div>
        <p class="text-sm text-gray-500">
            Select Item 1, then press ArrowRight → jumps directly to Item 4 (skipping disabled Items 2 and 3)
        </p>
    </div>
</DemoSection>

<DemoSection Title="Keyboard Navigation: Roving TabIndex"
             Description="Only the selected (or first enabled if none selected) tab has tabindex=0. Tab key exits the group entirely.">
    <div class="flex flex-col gap-4">
        <div class="flex items-center gap-4">
            <button type="button"
                    class="rounded border border-gray-300 px-3 py-2 text-sm hover:bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:outline-none"
                    @onfocus="@(() => rovingFocusLocation = "Before button")">
                Before (Tab target)
            </button>

            <TabsRoot TValue="string"
                      Value="@rovingValue"
                      ValueChanged="@(v => { rovingValue = v; rovingFocusLocation = $"Tab: {v}"; })">
                <TabsList TValue="string"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("rov-a")"
                             ClassValue="@(state => TabClassWithFocusRing(state))">
                        A
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("rov-b")"
                             ClassValue="@(state => TabClassWithFocusRing(state))">
                        B
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("rov-c")"
                             ClassValue="@(state => TabClassWithFocusRing(state))">
                        C
                    </TabsTab>
                </TabsList>
            </TabsRoot>

            <button type="button"
                    class="rounded border border-gray-300 px-3 py-2 text-sm hover:bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:outline-none"
                    @onfocus="@(() => rovingFocusLocation = "After button")">
                After (Tab target)
            </button>
        </div>
        <div class="text-sm text-gray-600">
            <strong>Selected:</strong> @(rovingValue ?? "(none)") |
            <strong>Last focus:</strong> @rovingFocusLocation
        </div>
        <p class="text-sm text-gray-500">
            1. No selection: Tab focuses "A" (first enabled), Tab again goes to "After" button<br/>
            2. Select "C" with click, Tab away, then Shift+Tab back → focus returns to "C"<br/>
            3. Only the active tab shows the teal ring (tabindex=0 indicator)
        </p>
    </div>
</DemoSection>

<DemoSection Title="Keyboard Navigation: Home/End Keys"
             Description="Home key jumps to first enabled tab. End key jumps to last enabled tab.">
    <div class="flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="string"
                      Value="@homeEndValue"
                      ValueChanged="@(v => homeEndValue = v)">
                <TabsList TValue="string"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("he1")"
                             ClassValue="@(state => TabClass(state))">
                        First
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("he2")"
                             ClassValue="@(state => TabClass(state))">
                        Second
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("he3")"
                             ClassValue="@(state => TabClass(state))">
                        Third
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("he4")"
                             ClassValue="@(state => TabClass(state))">
                        Fourth
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("he5")"
                             ClassValue="@(state => TabClass(state))">
                        Fifth (Last)
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="string"
                           Value="@("he1")"
                           ClassValue="@(_ => PanelClass())">
                    First panel
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("he2")"
                           ClassValue="@(_ => PanelClass())">
                    Second panel
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("he3")"
                           ClassValue="@(_ => PanelClass())">
                    Third panel
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("he4")"
                           ClassValue="@(_ => PanelClass())">
                    Fourth panel
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("he5")"
                           ClassValue="@(_ => PanelClass())">
                    Fifth panel
                </TabsPanel>
            </TabsRoot>
        </div>
        <div class="text-sm text-gray-600">
            <strong>Selected:</strong> @(homeEndValue ?? "(none)")
        </div>
        <p class="text-sm text-gray-500">
            1. Focus any tab, press Home → jumps to "First"<br/>
            2. Press End → jumps to "Fifth (Last)"
        </p>
    </div>
</DemoSection>

<DemoSection Title="ARIA Attributes"
             Description="Tabs have proper aria-selected, aria-controls, and panels have aria-labelledby.">
    <div class="w-full max-w-md">
        <TabsRoot TValue="string" DefaultValue="@("aria1")">
            <TabsList TValue="string"
                      aria-label="ARIA example tabs"
                      ClassValue="@(_ => TabsListClass())">
                <TabsTab TValue="string"
                         Value="@("aria1")"
                         id="tab-aria-1"
                         ClassValue="@(state => TabClass(state))">
                    Tab with ID
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("aria2")"
                         ClassValue="@(state => TabClass(state))">
                    Auto ID Tab
                </TabsTab>
            </TabsList>
            <TabsPanel TValue="string"
                       Value="@("aria1")"
                       id="panel-aria-1"
                       KeepMounted="true"
                       ClassValue="@(_ => PanelClass())">
                This panel has a custom ID and is controlled by the tab with id="tab-aria-1".
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("aria2")"
                       KeepMounted="true"
                       ClassValue="@(_ => PanelClass())">
                This panel has an auto-generated ID.
            </TabsPanel>
        </TabsRoot>
    </div>
    <p class="mt-2 text-sm text-gray-500">
        Inspect the DOM to see aria-selected, aria-controls (on tabs), and aria-labelledby (on panels).
    </p>
</DemoSection>

<DemoSection Title="Panel KeepMounted"
             Description="Panels can remain in the DOM when hidden using KeepMounted. Useful for preserving state.">
    <div class="flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="string" DefaultValue="@("keep1")">
                <TabsList TValue="string"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("keep1")"
                             ClassValue="@(state => TabClass(state))">
                        Tab with State
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("keep2")"
                             ClassValue="@(state => TabClass(state))">
                        Other Tab
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="string"
                           Value="@("keep1")"
                           KeepMounted="true"
                           ClassValue="@(_ => PanelClass())">
                    <div class="flex flex-col gap-3">
                        <p>This panel uses KeepMounted="true"</p>
                        <div class="flex items-center gap-2">
                            <label for="keepMountedInput" class="text-sm">Type something:</label>
                            <input type="text"
                                   id="keepMountedInput"
                                   @bind="keepMountedInput"
                                   class="rounded border border-gray-300 px-2 py-1 text-sm"/>
                        </div>
                        <p class="text-xs text-gray-500">Switch tabs and come back - the input value persists.</p>
                    </div>
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("keep2")"
                           KeepMounted="true"
                           ClassValue="@(_ => PanelClass())">
                    <p>This is the other tab. Switch back to see your input preserved.</p>
                </TabsPanel>
            </TabsRoot>
        </div>
        <p class="text-sm text-gray-500">
            Hidden panels have the hidden attribute but remain in the DOM (inspect to verify).
        </p>
    </div>
</DemoSection>

<DemoSection Title="Tabs Indicator"
             Description="An animated indicator that follows the active tab. Uses CSS custom properties for positioning.">
    <div class="w-full max-w-md">
        <TabsRoot TValue="string" DefaultValue="@("ind1")">
            <TabsList TValue="string"
                      ClassValue="@(_ => "relative flex gap-1 rounded-lg bg-gray-100 p-1")">
                <TabsIndicator TValue="string"
                               ClassValue="@(_ => "absolute rounded-md bg-white shadow transition-all duration-200")"
                               StyleValue="@(_ => "left: var(--tabs-indicator-active-tab-left); width: var(--tabs-indicator-active-tab-width); height: var(--tabs-indicator-active-tab-height); top: var(--tabs-indicator-active-tab-top);")"/>
                <TabsTab TValue="string"
                         Value="@("ind1")"
                         ClassValue="@(state => IndicatorTabClass(state))">
                    Overview
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("ind2")"
                         ClassValue="@(state => IndicatorTabClass(state))">
                    Analytics
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("ind3")"
                         ClassValue="@(state => IndicatorTabClass(state))">
                    Reports
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("ind4")"
                         ClassValue="@(state => IndicatorTabClass(state))">
                    Notifications
                </TabsTab>
            </TabsList>
            <TabsPanel TValue="string"
                       Value="@("ind1")"
                       ClassValue="@(_ => PanelClass())">
                Overview content
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("ind2")"
                       ClassValue="@(_ => PanelClass())">
                Analytics content
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("ind3")"
                       ClassValue="@(_ => PanelClass())">
                Reports content
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("ind4")"
                       ClassValue="@(_ => PanelClass())">
                Notifications content
            </TabsPanel>
        </TabsRoot>
    </div>
    <p class="mt-2 text-sm text-gray-500">
        The white indicator slides to follow the active tab using CSS custom properties.
    </p>
</DemoSection>

<DemoSection Title="Typed Values (Integer)"
             Description="Tabs can use any type as TValue, not just strings. This example uses integers.">
    <div class="flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="int"
                      Value="selectedIntTab"
                      ValueChanged="@(v => selectedIntTab = v)">
                <TabsList TValue="int"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="int"
                             Value="0"
                             ClassValue="@(state => TabClass(state))">
                        Tab 0
                    </TabsTab>
                    <TabsTab TValue="int"
                             Value="1"
                             ClassValue="@(state => TabClass(state))">
                        Tab 1
                    </TabsTab>
                    <TabsTab TValue="int"
                             Value="2"
                             ClassValue="@(state => TabClass(state))">
                        Tab 2
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="int"
                           Value="0"
                           ClassValue="@(_ => PanelClass())">
                    Content for tab index 0
                </TabsPanel>
                <TabsPanel TValue="int"
                           Value="1"
                           ClassValue="@(_ => PanelClass())">
                    Content for tab index 1
                </TabsPanel>
                <TabsPanel TValue="int"
                           Value="2"
                           ClassValue="@(_ => PanelClass())">
                    Content for tab index 2
                </TabsPanel>
            </TabsRoot>
        </div>
        <div class="text-sm text-gray-600">
            <strong>Selected tab index:</strong> @selectedIntTab
        </div>
    </div>
</DemoSection>

<DemoSection Title="OnValueChange Callback"
             Description="Event handler called when selection changes. Can be canceled to prevent the change.">
    <div class="flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="string"
                      OnValueChange="@HandleValueChange"
                      ClassValue="@(_ => "")">
                <TabsList TValue="string"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("cb1")"
                             ClassValue="@(state => TabClass(state))">
                        Tab A
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("cb2")"
                             ClassValue="@(state => TabClass(state))">
                        Tab B
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("cb3")"
                             ClassValue="@(state => TabClass(state))">
                        Tab C
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="string"
                           Value="@("cb1")"
                           ClassValue="@(_ => PanelClass())">
                    Panel A
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("cb2")"
                           ClassValue="@(_ => PanelClass())">
                    Panel B
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("cb3")"
                           ClassValue="@(_ => PanelClass())">
                    Panel C
                </TabsPanel>
            </TabsRoot>
        </div>
        <div class="text-sm text-gray-600">
            <strong>Change count:</strong> @changeCount
        </div>
    </div>

    <div class="mt-6 flex flex-col gap-4">
        <div class="w-full max-w-md">
            <TabsRoot TValue="string"
                      OnValueChange="@HandleCancelableChange">
                <TabsList TValue="string"
                          ClassValue="@(_ => TabsListClass())">
                    <TabsTab TValue="string"
                             Value="@("cancel1")"
                             ClassValue="@(state => TabClass(state))">
                        One
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("cancel2")"
                             ClassValue="@(state => TabClass(state))">
                        Two
                    </TabsTab>
                    <TabsTab TValue="string"
                             Value="@("cancel3")"
                             ClassValue="@(state => TabClass(state))">
                        Three
                    </TabsTab>
                </TabsList>
                <TabsPanel TValue="string"
                           Value="@("cancel1")"
                           ClassValue="@(_ => PanelClass())">
                    Panel One
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("cancel2")"
                           ClassValue="@(_ => PanelClass())">
                    Panel Two
                </TabsPanel>
                <TabsPanel TValue="string"
                           Value="@("cancel3")"
                           ClassValue="@(_ => PanelClass())">
                    Panel Three
                </TabsPanel>
            </TabsRoot>
        </div>
        <label class="flex items-center gap-2">
            <input type="checkbox" @bind="preventTabChange" class="rounded"/>
            <span class="text-sm text-gray-700">Cancel next tab change</span>
        </label>
    </div>
</DemoSection>

<DemoSection Title="Card-Style Tabs"
             Description="Custom styling to create card-style tab selection.">
    <div class="w-full max-w-lg">
        <TabsRoot TValue="string" DefaultValue="@("card-basic")">
            <TabsList TValue="string"
                      ClassValue="@(_ => "grid grid-cols-3 gap-4")">
                <TabsTab TValue="string"
                         Value="@("card-basic")"
                         ClassValue="@(state => CardTabClass(state))">
                    <div class="p-4 text-left">
                        <div class="font-semibold">Basic</div>
                        <div class="text-sm text-gray-500">For individuals</div>
                        <div class="mt-2 text-lg font-bold text-indigo-600">$0/mo</div>
                    </div>
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("card-pro")"
                         ClassValue="@(state => CardTabClass(state))">
                    <div class="p-4 text-left">
                        <div class="font-semibold">Pro</div>
                        <div class="text-sm text-gray-500">For small teams</div>
                        <div class="mt-2 text-lg font-bold text-indigo-600">$29/mo</div>
                    </div>
                </TabsTab>
                <TabsTab TValue="string"
                         Value="@("card-enterprise")"
                         ClassValue="@(state => CardTabClass(state))">
                    <div class="p-4 text-left">
                        <div class="font-semibold">Enterprise</div>
                        <div class="text-sm text-gray-500">For organizations</div>
                        <div class="mt-2 text-lg font-bold text-indigo-600">$99/mo</div>
                    </div>
                </TabsTab>
            </TabsList>
            <TabsPanel TValue="string"
                       Value="@("card-basic")"
                       ClassValue="@(_ => PanelClass())">
                <ul class="list-disc pl-5 text-gray-600">
                    <li>1 user</li>
                    <li>5 GB storage</li>
                    <li>Email support</li>
                </ul>
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("card-pro")"
                       ClassValue="@(_ => PanelClass())">
                <ul class="list-disc pl-5 text-gray-600">
                    <li>Up to 10 users</li>
                    <li>50 GB storage</li>
                    <li>Priority support</li>
                    <li>Advanced analytics</li>
                </ul>
            </TabsPanel>
            <TabsPanel TValue="string"
                       Value="@("card-enterprise")"
                       ClassValue="@(_ => PanelClass())">
                <ul class="list-disc pl-5 text-gray-600">
                    <li>Unlimited users</li>
                    <li>Unlimited storage</li>
                    <li>24/7 phone support</li>
                    <li>Custom integrations</li>
                    <li>SLA guarantee</li>
                </ul>
            </TabsPanel>
        </TabsRoot>
    </div>
</DemoSection>

</ComponentShowcase>

@code {
    [Parameter]
    public bool IsWasmMode { get; set; }

    private string? controlledValue = "first";
    private string? directionValue = "dir1";
    private string lastActivationDirection = "none";
    private string? activateOnFocusValue;
    private string? manualActivationValue;
    private string? loopValue;
    private string? skipDisabledValue;
    private string? rovingValue;
    private string rovingFocusLocation = "(none)";
    private string? homeEndValue;
    private string keepMountedInput = "";
    private int selectedIntTab;
    private int changeCount;
    private bool preventTabChange;

    private void HandleDirectionValueChange(string? value)
    {
        directionValue = value;
    }

    private void HandleDirectionChange(TabsValueChangeEventArgs<string> e)
    {
        lastActivationDirection = e.ActivationDirection.ToString().ToLowerInvariant();
    }

    private void HandleValueChange(TabsValueChangeEventArgs<string> e)
    {
        changeCount++;
    }

    private void HandleCancelableChange(TabsValueChangeEventArgs<string> e)
    {
        if (preventTabChange)
        {
            e.Cancel();
            preventTabChange = false;
        }
    }

    private static string GetDirectionBorderClass(TabsRootState state)
    {
        return state.ActivationDirection switch
        {
            ActivationDirection.Left => "border-blue-500",
            ActivationDirection.Right => "border-green-500",
            ActivationDirection.Up => "border-purple-500",
            ActivationDirection.Down => "border-orange-500",
            _ => "border-gray-200"
        };
    }

    private static string TabsListClass()
    {
        return "flex gap-1 border-b border-gray-200";
    }

    private static string TabClass(TabsTabState state)
    {
        var baseClass = "relative px-4 py-2 text-sm font-medium transition-colors outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:ring-offset-2 rounded-t-md";

        if (state.Disabled)
            return $"{baseClass} text-gray-400 cursor-not-allowed";

        if (state.Active)
            return $"{baseClass} text-indigo-600 border-b-2 border-indigo-600 -mb-px";

        return $"{baseClass} text-gray-600 hover:text-gray-900";
    }

    private static string TabClassWithFocusRing(TabsTabState state)
    {
        var baseClass = "relative px-4 py-2 text-sm font-medium transition-colors outline-none";

        if (state.Disabled)
            return $"{baseClass} text-gray-400 cursor-not-allowed";

        if (state.Active)
            return $"{baseClass} text-indigo-600 border-b-2 border-indigo-600 -mb-px ring-2 ring-teal-400 ring-offset-1";

        return $"{baseClass} text-gray-600 hover:text-gray-900";
    }

    private static string PanelClass()
    {
        return "mt-4 rounded-lg bg-gray-50 p-4 outline-none";
    }

    private static string VerticalTabsListClass()
    {
        return "flex flex-col gap-1 border-r border-gray-200 pr-4";
    }

    private static string VerticalTabClass(TabsTabState state)
    {
        var baseClass = "relative px-4 py-2 text-sm font-medium transition-colors outline-none text-left rounded-l-md focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:ring-offset-2";

        if (state.Disabled)
            return $"{baseClass} text-gray-400 cursor-not-allowed";

        if (state.Active)
            return $"{baseClass} text-indigo-600 bg-indigo-50 border-r-2 border-indigo-600 -mr-px";

        return $"{baseClass} text-gray-600 hover:text-gray-900 hover:bg-gray-50";
    }

    private static string VerticalPanelClass()
    {
        return "rounded-lg bg-gray-50 p-4 outline-none";
    }

    private static string IndicatorTabClass(TabsTabState state)
    {
        var baseClass = "relative z-10 px-4 py-2 text-sm font-medium transition-colors outline-none rounded-md focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:ring-offset-2";

        if (state.Disabled)
            return $"{baseClass} text-gray-400 cursor-not-allowed";

        if (state.Active)
            return $"{baseClass} text-gray-900";

        return $"{baseClass} text-gray-600 hover:text-gray-900";
    }

    private static string CardTabClass(TabsTabState state)
    {
        var baseClass = "block rounded-lg border-2 transition-all outline-none cursor-pointer focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:ring-offset-2";

        if (state.Disabled)
            return $"{baseClass} border-gray-200 bg-gray-50 opacity-50";

        if (state.Active)
            return $"{baseClass} border-indigo-600 bg-indigo-50";

        return $"{baseClass} border-gray-200 bg-white hover:border-gray-300";
    }
}
